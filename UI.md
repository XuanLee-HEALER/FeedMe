# FeedMe UI/UX 设计规范

> macOS 菜单栏 RSS 阅读器的界面设计指南

## 设计理念

### 核心原则

| 原则 | 说明 |
|------|------|
| **原生优先** | 遵循 Apple Human Interface Guidelines，使用系统原生控件 |
| **轻量无感** | 菜单栏应用应该"隐形"，只在需要时出现 |
| **信息密度** | 有限空间内最大化信息价值，减少视觉噪音 |
| **快速响应** | 点击即开，无等待，无加载屏幕 |

### 设计风格

```
Style: macOS Native + Minimal
Keywords: 原生、轻量、高效、信息优先、无干扰
```

---

## 色彩系统

### 语义色彩

| 用途 | Light Mode | Dark Mode | 说明 |
|------|------------|-----------|------|
| **未读指示** | `#007AFF` (systemBlue) | `#0A84FF` | 未读文章标记 |
| **成功状态** | `#34C759` (systemGreen) | `#30D158` | 刷新成功、同步完成 |
| **警告状态** | `#FF9500` (systemOrange) | `#FF9F0A` | 源获取失败 |
| **错误状态** | `#FF3B30` (systemRed) | `#FF453A` | 网络错误、解析失败 |
| **次要文字** | `#8E8E93` (secondaryLabel) | `#8E8E93` | 时间、来源等辅助信息 |

### 背景色

使用系统提供的动态颜色，自动适配 Light/Dark Mode：

```swift
// SwiftUI
Color(.windowBackgroundColor)
Color(.controlBackgroundColor)
Color(.separatorColor)

// AppKit
NSColor.windowBackgroundColor
NSColor.controlBackgroundColor
NSColor.separatorColor
```

---

## 菜单栏图标

### 状态图标设计

```
┌─────────────────────────────────────────┐
│  状态栏图标规格                           │
├─────────────────────────────────────────┤
│  尺寸: 18x18 pt (1x), 36x36 px (2x)     │
│  格式: SF Symbol 或 Template Image       │
│  颜色: 单色，跟随系统菜单栏色调           │
└─────────────────────────────────────────┘
```

### 图标状态

| 状态 | 图标 | SF Symbol | 说明 |
|------|------|-----------|------|
| 正常 | 📰 | `newspaper` | 默认状态 |
| 有未读 | 📰 + 数字 | `newspaper` + badge | 显示未读数量 |
| 刷新中 | 🔄 | `arrow.triangle.2.circlepath` | 动画旋转 |
| 错误 | ⚠️ | `exclamationmark.triangle` | 有源获取失败 |

### 未读徽章显示

```
┌──────────────────────────────────────┐
│  未读数显示规则                        │
├──────────────────────────────────────┤
│  0 条    →  仅图标，无数字             │
│  1-99 条 →  图标 + 数字 (如 "📰 5")    │
│  99+ 条  →  图标 + "99+"              │
└──────────────────────────────────────┘
```

---

## 左键菜单（文章列表）

### 菜单结构

```
┌────────────────────────────────────────┐
│  最近更新                    (禁用标题) │
├────────────────────────────────────────┤
│  ● 文章标题一                          │  ← 未读（蓝色圆点）
│    文章标题二                          │  ← 已读（无标记）
│  ● 文章标题三                          │
│  ● 文章标题四                          │
│  ● 文章标题五                          │
├────────────────────────────────────────┤
│  … 更多 (23)                        ▶ │  ← 子菜单展开
├────────────────────────────────────────┤
│  ⟳ 刷新                           ⌘R │
│  ✓ 全部标为已读                        │
└────────────────────────────────────────┘
```

### 文章条目设计

**单行模式（默认）**
```
● 这是一篇很长的文章标题可能会被截断...
```

**双行模式（可选，未来功能）**
```
● 这是文章标题
  来源名称 · 2小时前
```

### 交互行为

| 操作 | 行为 |
|------|------|
| 左键单击条目 | 在默认浏览器中打开文章 |
| ⌘ + 单击 | 在后台标签页打开 |
| 悬停 | 显示完整标题 tooltip |

---

## 右键菜单（应用菜单）

### 菜单结构

```
┌────────────────────────────────────────┐
│  ⟳ 刷新所有源                      ⌘R │
├────────────────────────────────────────┤
│  📋 管理订阅源…                        │
│  ⚙ 设置…                          ⌘, │
├────────────────────────────────────────┤
│  ℹ 关于 FeedMe                        │
├────────────────────────────────────────┤
│  ⏻ 退出                           ⌘Q │
└────────────────────────────────────────┘
```

---

## 订阅源管理窗口

### 窗口规格

```
┌─────────────────────────────────────────┐
│  尺寸: 600 x 450 pt (最小)              │
│  样式: NSWindow.StyleMask.titled        │
│       + .closable + .resizable          │
│  位置: 屏幕居中                          │
└─────────────────────────────────────────┘
```

### 布局设计

```
┌──────────────────────────────────────────────────────────┐
│  订阅源管理                                    ⊖ ⊕ ⊗    │
├──────────────────────┬───────────────────────────────────┤
│                      │                                   │
│  ┌────────────────┐  │  基本信息                         │
│  │ 📰 Simon's Blog │  │  ┌─────────────────────────────┐ │
│  │    simonwilli… │  │  │ 标题: Simon Willison's Blog │ │
│  ├────────────────┤  │  │ URL:  https://simonwill...  │ │
│  │ 📰 Daring Fire… │  │  └─────────────────────────────┘ │
│  │    daringfire… │  │                                   │
│  ├────────────────┤  │  状态                             │
│  │ ⚠️ Tech Blog    │  │  ┌─────────────────────────────┐ │
│  │    获取失败     │  │  │ 启用: ✓ 是                  │ │
│  └────────────────┘  │  │ 最后刷新: 10分钟前           │ │
│                      │  │ 错误: (无)                   │ │
│  ┌──┐ ┌──┐          │  └─────────────────────────────┘ │
│  │＋│ │－│          │                                   │
│  └──┘ └──┘          │  设置                             │
│                      │  ┌─────────────────────────────┐ │
│                      │  │ 刷新间隔: [使用全局设置 ▼]   │ │
│                      │  └─────────────────────────────┘ │
├──────────────────────┴───────────────────────────────────┤
│  Sidebar: 200pt      │  Detail: flex                     │
└──────────────────────────────────────────────────────────┘
```

### 列表项状态

| 状态 | 视觉表现 |
|------|----------|
| 正常 | 标题 + URL（灰色小字） |
| 禁用 | 整行变灰 + 暂停图标 |
| 错误 | 橙色警告图标 + 错误提示 |
| 刷新中 | 加载指示器旋转 |

---

## 设置窗口

### 窗口规格

```
┌─────────────────────────────────────────┐
│  尺寸: 450 x 400 pt (固定)              │
│  样式: Settings 窗口风格                 │
│  标签: 可选多标签页（通用/高级）          │
└─────────────────────────────────────────┘
```

### 布局设计

```
┌────────────────────────────────────────────┐
│  设置                            ⊖ ⊕ ⊗   │
├────────────────────────────────────────────┤
│                                            │
│  刷新设置                                   │
│  ┌────────────────────────────────────┐   │
│  │  刷新间隔        [15 分钟      ▼]  │   │
│  └────────────────────────────────────┘   │
│                                            │
│  阅读行为                                   │
│  ┌────────────────────────────────────┐   │
│  │  [✓] 点击后自动标为已读             │   │
│  │                                    │   │
│  │  排序方式        [未读优先      ▼]  │   │
│  │                                    │   │
│  │  列表显示条数    [5] ◀────▶        │   │
│  └────────────────────────────────────┘   │
│                                            │
│  通知                                       │
│  ┌────────────────────────────────────┐   │
│  │  [✓] 启用新文章通知                 │   │
│  └────────────────────────────────────┘   │
│                                            │
│  高级                                       │
│  ┌────────────────────────────────────┐   │
│  │  [ ] 开机自动启动                   │   │
│  └────────────────────────────────────┘   │
│                                            │
└────────────────────────────────────────────┘
```

---

## 添加订阅源 Sheet

### 设计规格

```
┌─────────────────────────────────────────┐
│  尺寸: 400 x 200 pt                     │
│  样式: Sheet (附着在父窗口)              │
└─────────────────────────────────────────┘
```

### 布局设计

```
┌────────────────────────────────────────────┐
│  添加订阅源                                 │
├────────────────────────────────────────────┤
│                                            │
│  ┌────────────────────────────────────┐   │
│  │ https://example.com/feed.xml       │   │
│  └────────────────────────────────────┘   │
│  输入 Feed URL 或网站地址                   │
│                                            │
│  ┌────────────────────────────────────┐   │
│  │ ⚠️ 未找到有效的 RSS Feed            │   │  ← 错误提示（红色）
│  └────────────────────────────────────┘   │
│                                            │
│              [取消]        [添加]          │
│                                            │
└────────────────────────────────────────────┘
```

### 状态流转

```
输入 URL → [添加] → 验证中(按钮禁用+加载) → 成功(关闭) / 失败(显示错误)
```

---

## 动画与过渡

### 原则

- 使用系统默认动画时长（约 0.25s）
- 避免过度动画，保持轻量感
- 支持 `prefers-reduced-motion`

### 具体动画

| 元素 | 动画 | 时长 |
|------|------|------|
| 菜单出现 | 系统默认淡入 | ~0.15s |
| 刷新图标 | 顺时针旋转 | 持续到完成 |
| 窗口出现 | 系统默认缩放+淡入 | ~0.25s |
| 列表项变化 | 淡入淡出 | ~0.2s |

---

## 键盘快捷键

### 全局快捷键

| 快捷键 | 功能 |
|--------|------|
| `⌘R` | 刷新所有源 |
| `⌘,` | 打开设置 |
| `⌘Q` | 退出应用 |

### 窗口内快捷键

| 快捷键 | 功能 | 上下文 |
|--------|------|--------|
| `⌘N` | 添加订阅源 | 管理窗口 |
| `⌫` | 删除选中项 | 管理窗口 |
| `↑/↓` | 导航列表 | 所有列表 |
| `⏎` | 确认/打开 | 所有 |
| `⎋` | 取消/关闭 | Sheet/弹窗 |

---

## 无障碍设计

### VoiceOver 支持

- 所有交互元素提供 `accessibilityLabel`
- 状态变化通过 `accessibilityValue` 表达
- 图标按钮提供文字描述

### 示例

```swift
Button {
    refreshAll()
} label: {
    Image(systemName: "arrow.clockwise")
}
.accessibilityLabel("刷新所有订阅源")
.accessibilityHint("双击以刷新")
```

### 对比度

- 文字与背景对比度 ≥ 4.5:1
- 重要操作按钮对比度 ≥ 3:1
- 使用系统语义色彩自动满足要求

---

## 空状态设计

### 无订阅源

```
┌────────────────────────────────────────┐
│                                        │
│            📰                          │
│                                        │
│      还没有订阅任何 Feed                │
│                                        │
│      [+ 添加订阅源]                     │
│                                        │
└────────────────────────────────────────┘
```

### 无未读文章

```
┌────────────────────────────────────────┐
│  最近更新                              │
├────────────────────────────────────────┤
│                                        │
│      ✓ 全部已读                        │
│                                        │
├────────────────────────────────────────┤
│  ⟳ 刷新                           ⌘R │
└────────────────────────────────────────┘
```

### 网络错误

```
┌────────────────────────────────────────┐
│  最近更新                              │
├────────────────────────────────────────┤
│                                        │
│      ⚠️ 无法连接网络                   │
│      请检查网络设置后重试               │
│                                        │
│      [重试]                            │
│                                        │
└────────────────────────────────────────┘
```

---

## 通知设计

### 新文章通知

```
┌────────────────────────────────────────────┐
│  📰 FeedMe                            now │
│  ──────────────────────────────────────── │
│  5 篇新文章                                │
│  来自 Simon's Blog, Daring Fireball       │
└────────────────────────────────────────────┘
```

### 通知规则

- 批量通知：多篇文章合并为一条
- 静默时段：尊重系统勿扰模式
- 点击行为：打开文章列表菜单

---

## 实现清单

### Phase 1 - 基础功能 ✅
- [x] 菜单栏图标显示
- [x] 左键菜单（文章列表）
- [x] 右键菜单（应用菜单）
- [x] 未读数徽章

### Phase 2 - 管理界面 ✅
- [x] 订阅源管理窗口
- [x] 设置窗口
- [x] 添加订阅源 Sheet
- [x] 空状态设计（无订阅源、无文章、错误状态）

### Phase 3 - 体验优化 ✅
- [x] 刷新动画（菜单栏图标旋转）
- [x] 键盘快捷键完善（⌘N 添加、⌘I 导入、⌘E 导出、Delete 删除）
- [x] VoiceOver 支持（所有交互元素添加 accessibilityLabel）
- [x] 通知功能（新文章系统通知）

### Phase 4 - 高级功能 ✅
- [x] OPML 导入/导出
- [ ] 双行模式切换（未来功能）
- [ ] 自定义主题色（未来功能）
- [ ] 多窗口支持（未来功能）

---

## 参考资源

- [Apple Human Interface Guidelines - macOS](https://developer.apple.com/design/human-interface-guidelines/macos)
- [SF Symbols](https://developer.apple.com/sf-symbols/)
- [NetNewsWire](https://netnewswire.com/) - 优秀的开源 RSS 阅读器参考
